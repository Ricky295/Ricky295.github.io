<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sudoku Generator Demo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 20px;
    }
    
    .sudoku-table {
      border-collapse: collapse;
      margin: 20px 0;
      border: 2px solid #333;
    }
    
    .sudoku-cell {
      width: 40px;
      height: 40px;
      text-align: center;
      font-size: 20px;
      border: 1px solid #ddd;
      background-color: #f9f9f9;
    }
    
    .sudoku-cell.given {
      font-weight: bold;
      background-color: #e6e6e6;
    }
    
    .sudoku-cell[contenteditable="true"] {
      cursor: pointer;
    }
    
    .sudoku-cell[contenteditable="true"]:focus {
      outline: 2px solid #4CAF50;
      background-color: #f0f9f0;
    }
    
    /* Border styling for 3x3 boxes */
    .box-border-right {
      border-right: 2px solid #333;
    }
    
    .box-border-bottom {
      border-bottom: 2px solid #333;
    }
    
    .controls {
      margin: 20px 0;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    button {
      padding: 8px 12px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    
    button:hover {
      background-color: #45a049;
    }
    
    .difficulty-control {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .date-control {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }
    
    .info {
      margin-top: 20px;
      text-align: center;
    }

    .difficulty-label {
      display: inline-block;
      min-width: 60px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>Sudoku Generator</h1>
  
  <div class="controls">
    <div class="difficulty-control">
      <label for="difficulty">Difficulty: </label>
      <input type="range" id="difficulty" min="0" max="4" value="2" step="0.25" style="width: 150px;">
      <span id="difficulty-value" class="difficulty-label">Hard (2)</span>
    </div>
    <button id="new-game">New Game</button>
    <button id="daily-puzzle">Today's Puzzle</button>
    <button id="show-solution">Show Solution</button>
  </div>

  <div class="date-control">
    <label for="custom-date">Custom Daily Puzzle: </label>
    <input type="date" id="custom-date">
    <button id="generate-custom-daily">Generate</button>
  </div>
  
  <table id="sudoku-table" class="sudoku-table"></table>
  
  <div class="info">
    <p id="givens-info">Givens: 0</p>
    <p id="puzzle-info">Random Puzzle</p>
  </div>
  
  <script src="NEWSudokuGenerator.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const tableElement = document.getElementById('sudoku-table');
      const difficultyInput = document.getElementById('difficulty');
      const difficultyValueElement = document.getElementById('difficulty-value');
      const newGameBtn = document.getElementById('new-game');
      const dailyPuzzleBtn = document.getElementById('daily-puzzle');
      const showSolutionBtn = document.getElementById('show-solution');
      const givensInfo = document.getElementById('givens-info');
      const puzzleInfo = document.getElementById('puzzle-info');
      const customDateInput = document.getElementById('custom-date');
      const generateCustomDailyBtn = document.getElementById('generate-custom-daily');
      
      let generator = new SudokuGenerator();
      let currentPuzzle = null;
      let currentSolution = null;
      
      // Initialize date input with today's date
      const today = new Date();
      const year = today.getFullYear();
      const month = String(today.getMonth() + 1).padStart(2, '0');
      const day = String(today.getDate()).padStart(2, '0');
      customDateInput.value = `${year}-${month}-${day}`;
      
      // Update difficulty value display
      function updateDifficultyLabel() {
        const difficulty = parseFloat(difficultyInput.value);
        let difficultyName = "";
        
        if (difficulty < 0.5) difficultyName = "Easy";
        else if (difficulty < 1.5) difficultyName = "Medium";
        else if (difficulty < 2.5) difficultyName = "Hard";
        else if (difficulty < 3.5) difficultyName = "Expert";
        else difficultyName = "Insane";
        
        difficultyValueElement.textContent = `${difficultyName} (${difficulty})`;
      }
      
      // Create the table-based Sudoku grid
      function createTableGrid() {
        tableElement.innerHTML = '';
        
        for (let row = 0; row < 9; row++) {
          const tr = document.createElement('tr');
          
          for (let col = 0; col < 9; col++) {
            const td = document.createElement('td');
            td.className = 'sudoku-cell';
            td.dataset.row = row;
            td.dataset.col = col;
            
            // Add border styling for 3x3 boxes
            if (col === 2 || col === 5) {
              td.classList.add('box-border-right');
            }
            if (row === 2 || row === 5) {
              td.classList.add('box-border-bottom');
            }
            
            // Set up event listeners for editable cells
            td.addEventListener('input', function(e) {
              // Only allow numbers 1-9
              let content = this.textContent;
              if (!/^[1-9]?$/.test(content)) {
                this.textContent = content.replace(/[^1-9]/g, '').substring(0, 1);
              }
            });
            
            // Prevent pasting of non-number content
            td.addEventListener('paste', function(e) {
              e.preventDefault();
              const paste = (e.clipboardData || window.clipboardData).getData('text');
              const digit = paste.replace(/[^1-9]/g, '').substring(0, 1);
              if (digit) {
                this.textContent = digit;
              }
            });
            
            // Keep focus within the number limit
            td.addEventListener('keydown', function(e) {
              if (e.key !== 'Tab' && e.key !== 'ArrowLeft' && e.key !== 'ArrowRight' && 
                  e.key !== 'ArrowUp' && e.key !== 'ArrowDown' && e.key !== 'Backspace' && 
                  e.key !== 'Delete' && (e.key < '1' || e.key > '9')) {
                e.preventDefault();
              }
            });
            
            tr.appendChild(td);
          }
          
          tableElement.appendChild(tr);
        }
      }
      
      // Update the grid with puzzle values
      function updateGrid(puzzle) {
        const cells = tableElement.querySelectorAll('.sudoku-cell');
        
        let givensCount = 0;
        
        cells.forEach(cell => {
          const row = parseInt(cell.dataset.row);
          const col = parseInt(cell.dataset.col);
          const value = puzzle[row][col];
          
          if (value !== 0) {
            // This is a given
            cell.textContent = value;
            cell.classList.add('given');
            cell.contentEditable = false;
            givensCount++;
          } else {
            // This is an empty cell for user input
            cell.textContent = '';
            cell.classList.remove('given');
            cell.contentEditable = true;
          }
        });
        
        // Update givens count
        givensInfo.textContent = `Givens: ${givensCount}`;
      }
      
      // Generate new puzzle based on difficulty
      function generatePuzzle() {
        const difficulty = parseFloat(difficultyInput.value);
        const result = generator.createPuzzle(difficulty);
        currentPuzzle = result.puzzle;
        currentSolution = result.solution;
        
        puzzleInfo.textContent = `Random Puzzle`;
        updateGrid(currentPuzzle);
      }
      
      // Generate today's daily puzzle
      function generateTodaysPuzzle() {
        const difficulty = parseFloat(difficultyInput.value);
        const result = generator.createDailyPuzzle(difficulty);
        currentPuzzle = result.puzzle;
        currentSolution = result.solution;
        
        const today = new Date();
        puzzleInfo.textContent = `Daily Puzzle for ${today.toLocaleDateString()}`;
        updateGrid(currentPuzzle);
      }
      
      // Generate custom daily puzzle
      function generateCustomDailyPuzzle() {
        const difficulty = parseFloat(difficultyInput.value);
        const dateString = customDateInput.value;
        
        if (!dateString) {
          alert('Please select a date');
          return;
        }
        
        const dateParts = dateString.split('-');
        const year = parseInt(dateParts[0]);
        const month = parseInt(dateParts[1]);
        const day = parseInt(dateParts[2]);
        
        const result = generator.createDailyPuzzle(difficulty, year, month, day);
        currentPuzzle = result.puzzle;
        currentSolution = result.solution;
        
        const displayDate = new Date(year, month - 1, day);
        puzzleInfo.textContent = `Daily Puzzle for ${displayDate.toLocaleDateString()}`;
        updateGrid(currentPuzzle);
      }
      
      // Show solution
      function showSolution() {
        if (currentSolution) {
          updateGrid(currentSolution);
        }
      }
      
      // Set up keyboard navigation between cells
      function setupKeyboardNavigation() {
        tableElement.addEventListener('keydown', function(e) {
          const cell = e.target.closest('.sudoku-cell');
          if (!cell || !cell.contentEditable) return;
          
          const row = parseInt(cell.dataset.row);
          const col = parseInt(cell.dataset.col);
          
          let nextRow = row;
          let nextCol = col;
          
          if (e.key === 'ArrowUp') nextRow = Math.max(0, row - 1);
          else if (e.key === 'ArrowDown') nextRow = Math.min(8, row + 1);
          else if (e.key === 'ArrowLeft') nextCol = Math.max(0, col - 1);
          else if (e.key === 'ArrowRight') nextCol = Math.min(8, col + 1);
          else return;
          
          e.preventDefault();
          
          const nextCell = tableElement.querySelector(`.sudoku-cell[data-row="${nextRow}"][data-col="${nextCol}"]`);
          if (nextCell && nextCell.contentEditable === 'true') {
            nextCell.focus();
          }
        });
      }
      
      // Set up event listeners
      difficultyInput.addEventListener('input', updateDifficultyLabel);
      newGameBtn.addEventListener('click', generatePuzzle);
      dailyPuzzleBtn.addEventListener('click', generateTodaysPuzzle);
      generateCustomDailyBtn.addEventListener('click', generateCustomDailyPuzzle);
      showSolutionBtn.addEventListener('click', showSolution);
      
      // Initialize
      updateDifficultyLabel();
      createTableGrid();
      setupKeyboardNavigation();
      generatePuzzle();
    });
  </script>
</body>
</html>
